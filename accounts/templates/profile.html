{% extends 'main.html' %}

{% block content %}
<title>F1 Prode - Perfil de Usuario</title>
<link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@400;600;700&display=swap" rel="stylesheet">
{% load static %}
<link rel="stylesheet" href="{% static 'css/profile-style.css' %}">

<body>
    <div class="profile-container">
        <div class="profile-header">
            <img src="/api/placeholder/100/100" alt="Avatar" class="profile-avatar">
            <div class="profile-info">
                <h1 class="profile-name">{{ user.first_name }} {{ user.last_name }}</h1>
                <div class="profile-username">@{{ user.username }}</div>
                <div class="profile-status">
                    {% if user.is_active %}
                        User active since {{ user.date_joined|date:"F Y" }}
                    {% else %}
                        Inactive User
                    {% endif %}
                </div>
            </div>
            <div class="rank-badge">
                <div class="rank-number">{{ actual_season.position }}</div>
                <div class="rank-label">Ranking</div>
            </div>
        </div>
        
        <div class="stats-section">
            <h2 class="section-title">General Statistics</h2>
            <div class="stats-grid">
                <div class="stats-box">
                    <h4>Total Points</h4>
                    <div class="stats-value">{{ amount_points }}</div>
                </div>
                <div class="stats-box">
                    <h4>Participated Races</h4>
                    <div class="stats-value">{{ amount_races }}</div>
                </div>
                <div class="stats-box">
                    <h4>Best Scoring</h4>
                    <div class="stats-value">{{ best_prediction.points_scored }}</div>
                    <div class="stats-subtitle">{{ best_prediction.session.grand_prix.location }} - {{best_prediction.session.grand_prix.season}}</div>
                </div>
                <div class="stats-box">
                    <h4>Guessed Positions</h4>
                    <div class="stats-value">{{ preds.guessed }}</div>
                </div>
                <div class="stats-box">
                    <h4>Best Season Result</h4>
                    <div class="stats-value">{{ best_season.position }}°</div>
                    <div class="stats-subtitle">Season {{ best_season.season }}</div>
                </div>
                <div class="stats-box">
                    <h4>Percentage of Guessed Positions</h4>
                    <div class="stats-value">{{ preds.avg_guess }}%</div>
                </div>
            </div>
        </div>
        
        <div class="season-performance">
            <div class="season-header">
                <div class="season-title">Season {{ actual_season.season }}</div>
                <div class="season-badge">{% if percentage_season < 100 %}In Progress{% else %}Finished{% endif %}</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" style="width: {{percentage_season}}%;"></div>
            </div>
            <div class="stats-grid">
                <div class="stats-box">
                    <h4>Points</h4>
                    <div class="stats-value">{{ actual_season.points }}</div>
                </div>
                <div class="stats-box">
                    <h4>Position</h4>
                    <div class="stats-value">{{ actual_season.position }}°</div>
                </div>
                <div class="stats-box">
                    <h4>Best Score</h4>
                    <div class="stats-value">{{ best_season_prediction.points_scored }}</div>
                    <div class="stats-subtitle">{{ best_season_prediction.session.grand_prix.location }} - {{best_season_prediction.session.grand_prix.season}}</div>
                </div>
                <div class="stats-box">
                    <h4>Participation</h4>
                    <div class="stats-value">{{ participations.avg_actual_season }}%</div>
                </div>
            </div>
        </div>
        
        <div class="best-predictions-section">
            <h2 class="section-title">Best Predictions</h2>
            <div class="prediction-list">
                {% for prediction in best_predictions %}
                <div class="prediction-item">
                    <div class="prediction-race">{{ prediction.race_name }}</div>
                    <div class="prediction-accuracy">
                        <span class="accuracy-label">Precisión:</span>
                        <span class="accuracy-value">{{ prediction.accuracy }}%</span>
                    </div>
                    <div class="prediction-details">
                        {% for position in prediction.correct_positions %}
                        <div class="prediction-position">
                            <span class="position-number">{{ position.pos }}</span>
                            <span class="driver-name">{{ position.driver_name }}</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
        
        <div class="race-history">
            <h2 class="section-title">Race History</h2>
            <div class="race-list">
                {% for race in recent_races %}
                <div class="race-item">
                    <img src="/api/placeholder/30/20" alt="{{ race.country }}" class="race-flag">
                    <div class="race-details">
                        <div class="race-name">{{ race.name }}</div>
                        <div class="race-date">{{ race.date|date:"d M Y" }}</div>
                    </div>
                    <div class="race-points">{{ race.points }}</div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</body>
</html>

{% endblock content %}